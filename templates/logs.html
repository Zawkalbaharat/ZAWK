<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸ•“ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« / Logs</title>
    <style>
        body {
            font-family: "Cairo", sans-serif;
            background-color: #fff;
            padding: 20px;
        }
        h2 {
            color: #2e7d32;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        button {
            padding: 8px 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            color: white;
            margin-bottom: 10px;
        }
        .export { background-color: #2196F3; }
        .back { background-color: #777; }
        input {
            width: 100%;
            padding: 4px;
            box-sizing: border-box;
            font-family: "Cairo", sans-serif;
        }
    </style>

    <!-- âœ… DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
</head>
<body>

<h2>ğŸ•“ Ø³Ø¬Ù„ Ø§Ù„Ø£Ø­Ø¯Ø§Ø« / Event Logs</h2>

<!-- Ø²Ø± Ø§Ù„Ø¹ÙˆØ¯Ø© -->
<a href="/dashboard"><button class="back">ğŸ”™ Ø±Ø¬ÙˆØ¹ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø´Ø±Ù</button></a>

<!-- Ø§Ù„Ø¬Ø¯ÙˆÙ„ -->
<table id="logsTable">
    <thead>
        <tr>
            <th>Ø§Ù„Ø§Ø³Ù…</th>
            <th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</th>
            <th>Ø§Ù„Ø¯ÙˆØ±</th>
            <th>Ø§Ù„ÙØ±Ø¹</th>
            <th>Ø§Ù„Ø­Ø¯Ø«</th>
            <th>Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨</th>
            <th>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</th>
            <th>Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª</th>
            <th>IP Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th>
        </tr>
        <!-- âœ… ØµÙ ÙÙ„Ø§ØªØ± Ø§Ù„Ø¨Ø­Ø« -->
        <tr>
            <th><input type="text" placeholder="ğŸ” Ø§Ù„Ø§Ø³Ù…" /></th>
            <th><input type="text" placeholder="ğŸ” Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ" /></th>
            <th><input type="text" placeholder="ğŸ” Ø§Ù„Ø¯ÙˆØ±" /></th>
            <th><input type="text" placeholder="ğŸ” Ø§Ù„ÙØ±Ø¹" /></th>
            <th><input type="text" placeholder="ğŸ” Ø§Ù„Ø­Ø¯Ø«" /></th>
            <th><input type="text" placeholder="ğŸ” Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨" /></th>
            <th><input type="text" placeholder="ğŸ” Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨" /></th>
            <th><input type="text" placeholder="ğŸ” Ø§Ù„ØªØ§Ø±ÙŠØ®" /></th>
            <th><input type="text" placeholder="ğŸ” IP" /></th>
        </tr>
    </thead>
    <tbody>
        {% for row in logs %}
        <tr>
            <td>{{ row['Ø§Ù„Ø§Ø³Ù…'] }}</td>
            <td>{{ row['Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ¸ÙŠÙÙŠ'] }}</td>
            <td>{{ row['Ø§Ù„Ø¯ÙˆØ±'] }}</td>
            <td>{{ row['Ø§Ù„ÙØ±Ø¹'] }}</td>
            <td>{{ row['Ø§Ù„Ø­Ø¯Ø«'] }}</td>
            <td>{{ row['Ù†ÙˆØ¹ Ø§Ù„Ø·Ù„Ø¨'] }}</td>
            <td>{{ row['Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨'] }}</td>
            <td>{{ row['Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª'] }}</td>
            <td>{{ row['IP Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…'] }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Ø²Ø± Ø§Ù„ØªØµØ¯ÙŠØ± -->
<button class="export" onclick="exportTableToExcel('logsTable', 'logs_export')">ğŸ“ ØªØµØ¯ÙŠØ± Excel</button>

<!-- âœ… Scripts -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script>
    $(document).ready(function() {
        var table = $('#logsTable').DataTable({
            "order": [[7, "desc"]],
            "pageLength": 50,
            "language": {
                "search": "ğŸ” Ø¨Ø­Ø«:",
                "lengthMenu": "Ø¹Ø±Ø¶ _MENU_ Ø³Ø¬Ù„ Ù„ÙƒÙ„ ØµÙØ­Ø©",
                "info": "Ø¹Ø±Ø¶ _START_ Ø¥Ù„Ù‰ _END_ Ù…Ù† Ø£ØµÙ„ _TOTAL_ Ø³Ø¬Ù„",
                "paginate": {
                    "first": "Ø§Ù„Ø£ÙˆÙ„",
                    "last": "Ø§Ù„Ø£Ø®ÙŠØ±",
                    "next": "Ø§Ù„ØªØ§Ù„ÙŠ",
                    "previous": "Ø§Ù„Ø³Ø§Ø¨Ù‚"
                },
                "zeroRecords": "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬",
                "infoEmpty": "Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª"
            }
        });

        // âœ… ÙÙ„ØªØ±Ø© Ø§Ù„Ø£Ø¹Ù…Ø¯Ø©
        $('#logsTable thead tr:eq(1) th').each(function(i) {
            $('input', this).on('keyup change', function() {
                if (table.column(i).search() !== this.value) {
                    table.column(i).search(this.value).draw();
                }
            });
        });
    });

    function exportTableToExcel(tableID, filename = '') {
        var dataType = 'application/vnd.ms-excel';
        var table = document.getElementById(tableID);
        var tableHTML = table.outerHTML.replace(/ /g, '%20');
        filename = filename ? filename + '.xls' : 'logs.xls';

        var downloadLink = document.createElement("a");
        document.body.appendChild(downloadLink);

        if (navigator.msSaveOrOpenBlob) {
            var blob = new Blob(['\ufeff', tableHTML], { type: dataType });
            navigator.msSaveOrOpenBlob(blob, filename);
        } else {
            downloadLink.href = 'data:' + dataType + ', ' + tableHTML;
            downloadLink.download = filename;
            downloadLink.click();
        }
    }
</script>

</body>
</html>
